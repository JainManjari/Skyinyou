class replyOnComment{constructor(e){this.replyForm=e;let t=this.replyForm.id.split("-")[1];this.commentContainer=$(`#comment-${t}-reply`),console.log(this.commentContainer),this.reply(t),this.commentID=t;let n=this;$(" .update-comment-button",this.commentContainer).each((function(){n.updateComment($(this)),console.log("update comments")})),$(" .delete-reply-button",this.commentContainer).each((function(){n.deleteReply($(this)),console.log("delete replies")})),$(" .update-reply-button",this.commentContainer).each((function(){n.updateReply($(this)),console.log("update replies")})),$(" .reply-reply-button",this.commentContainer).each((function(){n.replyReply1($(this)),console.log("reply reply 1")})),$(" .removetag-button",this.commentContainer).each((function(){n.removeTag($(this)),console.log("reply remove")}))}reply(e){let t=$(this.replyForm),n=this;t.submit((function(e){console.log(t),e.preventDefault(),$.ajax({type:"post",url:"/comments/create-comment-reply",data:t.serialize(),success:function(e){console.log(e.data,e.data.commentID),console.log($(`#comment-${e.data.commentID}-reply-list`));let t=$(`<li id="reply-${e.data.replyID}" onmouseup="removetagInvisible()">\n                    <div class="commentreply-like-box">\n                        <div class="commentreply-likes-number" id="commentreply-${e.data.replyID}-likes-number">\n                            <span data-target="#commentreply-${e.data.replyID}-likes" data-toggle="modal">\n                                \n                            </span>\n                        </div>\n                        <div class="modal commentreplylikemodal fade" id="commentreply-${e.data.replyID}-likes" role="dialog">\n                            <div class="modal-dialog ">\n                            \x3c!-- Modal content--\x3e\n                            <div class="modal-content">\n                                <div class="modal-header">\n                                <h4 class="modal-title" id="commentreply-${e.data.replyID}-like-title">Reply Reactions  \n                                    <span>\n                                        <i class="far fa-heart"></i>\n                                    </span>\n                                    </h4>\n                                </div>\n                                <div class="modal-body">\n                                    \n                                    <ul  class="commentreply-like-username-list " id="commentreply-${e.data.replyID}-likes-list">\n                                            \n                                    </ul>\n                                \n                                </div>\n                            \n                            </div>\n                            \n                            </div>\n                        </div>\n                   </div>\n                   <div class="dropdown bars">\n                   <div class="dropdown-toggle" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n                       <i class="fas fa-ellipsis-h"></i>\n                   </div>\n                   <div class="dropdown-menu drop-design" aria-labelledby="dropdownMenuLink">\n                       <div class="dropdown-item" data-toggle="modal" data-target="#deleteReplyModal-${e.data.replyID}">\n                         Delete <i class="fas fa-times" ></i> \n                       </div> \n                       <a class="dropdown-item update-reply-button" href="/comments/update-reply/${e.data.replyID}" >Edit <i class="fas fa-pen-square"></i></a>\n                     <a class="dropdown-item reply-reply-button" href="/comments/reply-reply-r1/${e.data.replyID}">Reply <i class="far fa-comment-dots"></i></a>\n                     <a class="dropdown-item toggle-like-button" href="/likes/toggle/?id=${e.data.replyID}&type=CommentReply" data-likes="0" id="reply-${e.data.replyID}-like-toggle">Like <i class="far fa-thumbs-up"></i></a>\n                   </div>\n               </div>\n                 <div class="modal fade" tabindex="-1" role="dialog" id="deleteReplyModal-${e.data.replyID}" aria-labelledby="exampleModalLabel" aria-hidden="true">\n                   <div class="modal-dialog replydeletemodaldialog" role="document">\n                     <div class="modal-content">\n                       <div class="modal-header">\n                         <h2 class="modal-title"><i class="fas fa-trash-alt"></i> Reply?</h2>\n                       </div>\n                       <div class="modal-body">\n                         <p>Are you sure you want to delete it?</p>\n                       </div>\n                       <div class="modal-footer">\n                         <a href="/comments/destroy-comment-reply/${e.data.replyID}" class="delete-reply-button btn btn-danger" data-dismiss="modal">Remove</a>\n                         <button type="button" class="btn btn-light" data-dismiss="modal">Discard</button>\n                       </div>\n                     </div>\n                   </div>\n                 </div>\n                   <div class="reply-author-tag">\n                       <a href="/users/profile/${e.data.replyUserID}">\n                           <span>${e.data.replyUserName}</span>\n                           <span class="${e.data.authorTag}-tag" style="width: 45px;"> ${e.data.authorTag}</span>\n                           \n                       </a>\n                   </div>\n               \n                   <div class="reply-content" id="reply-${e.data.replyUserID}-content">${e.data.replyContent}</div>\n                   \n                  </li>`);e.data.replyUserImage?$(" .reply-author-tag a",t).prepend(`<img src=${e.data.replyUserImage}>`):$(" .reply-author-tag a",t).prepend(`<div class="concealed-image" style="background:${e.data.replyUserBgColor};"><span>${e.data.replyUserName.split(" ")[0].charAt(0)}</span></div>`),$(`#comment-${e.data.commentID}-reply-list`).prepend(t),n.deleteReply($(" .delete-reply-button",t)),n.updateReply($(" .update-reply-button",t)),n.replyReply1($(" .reply-reply-button",t)),console.log($(" .toggle-like-button",t)),new ToggleLike($(" .toggle-like-button",t)),new Noty({theme:"relax",text:"Ahem, even comments need comments!",type:"success",layput:"topRight",timeout:1500}).show()},error:function(e){console.log("err********",e.responseText)}})}))}deleteReply(e){$(e).click((function(t){t.preventDefault(),console.log("inside delete reply button "),$.ajax({type:"get",url:$(e).prop("href"),success:function(e){console.log("remove comment reply: ",e.data,$("#reply-"+e.data.replyID)),$(".modal-backdrop").remove(),$("body").removeClass("modal-open"),$("#reply-"+e.data.replyID).remove(),new Noty({theme:"relax",text:"Can we have 1 min of silence?",type:"success",layout:"topRight",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}))}updateReply(e){$(e).click((function(t){t.preventDefault(),$.ajax({type:"get",url:$(e).prop("href"),success:function(e){if(console.log("h111",e.data.content),$(`#comment-${e.data.commentID}-reply .comment-update-tag a i`).css("pointer-events","none"),$(`#comment-${e.data.commentID}-reply .comment-update-tag a`).css("cursor","no-drop"),$(`#comment-${e.data.commentID}-reply .reply-body .comment-reply-form button`).css("pointer-events","none"),$(`#comment-${e.data.commentID}-reply .reply-body .comment-reply-form`).css("cursor","no-drop"),$(`#comment-${e.data.commentID}-reply-list>li>.bars`).each((function(){let e=$(this),t=$(" .dropdown-toggle",e);console.log(t),t.css("pointer-events","none"),e.css("cursor","no-drop")})),e.data.isReply){let t=e.data.content.content.trim();$(`#reply-${e.data.replyID} .reply-content .replyreplycontent`).remove(),$(`#reply-${e.data.replyID} .reply-content`).append(`<form action="/comments/update-reply-r2" method="post" class="reply-update-form"\n                        style="       margin: 0;\n                        margin-right: 0;\n                        margin-top: -6px;\n                        display: flex;\n                        justify-content: space-around;\n                        min-height: 30px;\n                        width: 86%;">\n                        <textarea required  name="content" onkeydown="autosize1(this)">${t}</textarea>\n                        <input type="hidden" name="reply" value="${e.data.replyID}">\n                        <button type="submit" style="align-self:center;" class="reply2button">U</button>\n                        </form>`)}else $(`#reply-${e.data.replyID} .reply-content`).remove(),$("#reply-"+e.data.replyID).append(`<form action="/comments/update-reply-r2" method="post" class="reply-update-form">\n                        <textarea required  name="content" onkeydown="autosize1(this)">${e.data.content}</textarea>\n                        <input type="hidden" name="reply" value="${e.data.replyID}">\n                        <button type="submit">U</button>\n                        </form>`);console.log("h1"),$(".reply-update-form").submit((function(e){console.log("h2"),e.preventDefault(),$.ajax({type:"post",url:"/comments/update-reply-r2",data:$(".reply-update-form").serialize(),success:function(e){console.log(e.data),$(`#comment-${e.data.commentID}-reply .reply-body .comment-reply-form button`).css("pointer-events","auto"),$(`#comment-${e.data.commentID}-reply .reply-body .comment-reply-form`).css("cursor","pointer"),$(`#comment-${e.data.commentID}-reply .comment-update-tag a i`).css("pointer-events","auto"),$(`#comment-${e.data.commentID}-reply .comment-update-tag a`).css("cursor","pointer"),$(`#comment-${e.data.commentID}-reply-list>li>.bars`).each((function(){let e=$(this),t=$(" .dropdown-toggle",e);console.log(t),t.css("pointer-events","auto"),e.css("cursor","pointer")})),e.data.edited&&$("#reply-"+e.data.replyID).prepend('<span class="editedReply">Edited</span>'),$(`#reply-${e.data.replyID} form`).remove(),e.data.isReply?(console.log("reply hai"),$(`#reply-${e.data.replyID} .reply-content`).append(`<span class="replyreplycontent">${e.data.content}</span>`)):$(`#reply-${e.data.replyID} `).append(`<div class="reply-content">${e.data.content}</div>`),new Noty({theme:"relax",text:"What should it's ancestors have all the fun?",type:"success",layput:"topRight",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}))},error:function(e){console.log("error ",e.responseText)}})}))}updateComment(e){console.log("up1",$(e).prop("href")),$(e).click((function(t){console.log("up2"),t.preventDefault(),$.ajax({type:"get",url:$(e).prop("href"),success:function(e){$(`#comment-${e.data.commentID}-reply .reply-body .comment-reply-form button`).css("pointer-events","none"),$(`#comment-${e.data.commentID}-reply .reply-body .comment-reply-form`).css("cursor","no-drop"),$(`#comment-${e.data.commentID}-reply-list>li>.bars>.dropdown-toggle`).each((function(){let e=$(this),t=$(" i",e);console.log(t),t.css("pointer-events","none"),e.css("cursor","no-drop")})),$(`#comment-${e.data.commentID}-reply .commentReplyContent`).remove(),$(`#comment-${e.data.commentID}-reply .commentReplyClass .reply-body`).prepend(`<form action="/comments/update-comment-c2" method="post" class="comment-update-form">\n                    <textarea required  name="content" onkeydown="autosize1(this)">${e.data.content}</textarea>\n                    <input type="hidden" name="comment" value="${e.data.commentID}">\n                    <button type="submit">U</button>\n                    </form>`);console.log($(".comment-update-form")),$(".comment-update-form").submit((function(e){console.log("h2"),e.preventDefault(),$.ajax({type:"post",url:"/comments/update-comment-c2",data:$(".comment-update-form").serialize(),success:function(e){console.log(e.data),$(`#comment-${e.data.commentID}-reply .reply-body .comment-reply-form button`).css("pointer-events","auto"),$(`#comment-${e.data.commentID}-reply .reply-body .comment-reply-form`).css("cursor","pointer"),$(`#comment-${e.data.commentID}-reply-list>li>.bars>.dropdown-toggle`).each((function(){let e=$(this),t=$(" i",e);console.log(t),t.css("pointer-events","auto"),e.css("cursor","pointer")})),e.data.edited&&$("#comment-"+e.data.commentID).prepend('<small class="comment-editedTag">\n                                        Edited\n                                        </small>'),$(`#comment-${e.data.commentID}-reply .commentReplyClass .reply-body .comment-update-form`).remove(),$(`#comment-${e.data.commentID}-reply .commentReplyClass .reply-body`).prepend(`<div class="commentReplyContent" id="comment-${e.data.commentID}-reply-content">\n                                    ${e.data.content}\n                                  </div>`),new Noty({theme:"relax",text:"This comment had a successful affair of words!",type:"success",layput:"topRight",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}))},error:function(e){console.log("error ",e.responseText)}})}))}replyReply1(e){let t=this;$(e).click((function(n){n.preventDefault(),$.ajax({type:"get",url:$(e).prop("href"),success:function(e){$(`#comment-${e.data.commentID}-reply .comment-update-tag a i`).css("pointer-events","none"),$(`#comment-${e.data.commentID}-reply .comment-update-tag a`).css("cursor","no-drop"),$(`#comment-${e.data.commentID}-reply .reply-body .comment-reply-form button`).css("pointer-events","none"),$(`#comment-${e.data.commentID}-reply .reply-body .comment-reply-form`).css("cursor","no-drop"),$(`#comment-${e.data.commentID}-reply-list>li>.bars`).each((function(){let e=$(this),t=$(" .dropdown-toggle",e);console.log(t),t.css("pointer-events","none"),e.css("cursor","no-drop")})),$(`#comment-${e.data.commentID}-reply-list`).append(`<li class="reply-form-list"><form action="/comments/reply-reply-r2" method="post" class="reply-reply-form">\n                    <div class="div1">\n                        <input type="text" name="userName" value="${e.data.name}" disabled>\n                        <input type="hidden" name="userID" value="${e.data.userID}" >\n                    </div>\n                    <div class="div2">\n                        <textarea required  name="content" onkeydown="autosize1(this)"></textarea>\n                        <input type="hidden" name="comment" value="${e.data.commentID}">\n                        <input type="hidden" name="reply" value="${e.data.replyID}">\n                        <button type="submit">R</button>\n                    </div>\n                    </form></li>`);!function(e){let t=e;$(".reply-reply-form").submit((function(e){console.log("yes2"),e.preventDefault(),$.ajax({type:"post",url:"/comments/reply-reply-r2",data:$(".reply-reply-form").serialize(),success:function(e){$(`#comment-${e.data.commentID}-reply .comment-update-tag a i`).css("pointer-events","auto"),$(`#comment-${e.data.commentID}-reply .comment-update-tag a`).css("cursor","pointer"),$(`#comment-${e.data.commentID}-reply .reply-body .comment-reply-form button`).css("pointer-events","auto"),$(`#comment-${e.data.commentID}-reply .reply-body .comment-reply-form`).css("cursor","pointer"),$(`#comment-${e.data.commentID}-reply-list>li>.bars`).each((function(){let e=$(this),t=$(" .dropdown-toggle",e);console.log(t),t.css("pointer-events","auto"),e.css("cursor","pointer")})),$(".reply-form-list").remove();let n=$(`<li id="reply-${e.data.replyID}" onmouseup="removetagInvisible()">\n                                    <div class="commentreply-like-box">\n                                            <div class="commentreply-likes-number" id="commentreply-${e.data.replyID}-likes-number">\n                                                <span data-target="#commentreply-${e.data.replyID}-likes" data-toggle="modal">\n                                                    \n                                                </span>\n                                            </div>\n                                            <div class="modal commentreplylikemodal fade" id="commentreply-${e.data.replyID}-likes" role="dialog">\n                                                <div class="modal-dialog ">\n                                                \x3c!-- Modal content--\x3e\n                                                <div class="modal-content">\n                                                    <div class="modal-header">\n                                                    <h4 class="modal-title" id="commentreply-${e.data.replyID}-like-title">Reply Reactions  \n                                                        <span>\n                                                            <i class="far fa-heart"></i>\n                                                        </span>\n                                                        </h4>\n                                                    </div>\n                                                    <div class="modal-body">\n                                                        \n                                                        <ul  class="commentreply-like-username-list " id="commentreply-${e.data.replyID}-likes-list">\n                                                                \n                                                        </ul>\n                                                    \n                                                    </div>\n                                                \n                                                </div>\n                                                \n                                                </div>\n                                            </div>\n                                    </div>\n                                    <div class="dropdown bars">\n                                    <div class="dropdown-toggle" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n                                        <i class="fas fa-ellipsis-h"></i>\n                                    </div>\n                                    <div class="dropdown-menu drop-design" aria-labelledby="dropdownMenuLink">\n                                        <div class="dropdown-item" data-toggle="modal" data-target="#deleteReplyModal-${e.data.replyID}">\n                                            Delete <i class="fas fa-times" ></i> \n                                        </div> \n                                        <a class="dropdown-item update-reply-button" href="/comments/update-reply/${e.data.replyID}" >Edit <i class="fas fa-pen-square"></i></a>\n                                        <a class="dropdown-item reply-reply-button" href="/comments/reply-reply-r1/${e.data.replyID}">Reply <i class="far fa-comment-dots"></i></a>\n                                        <a class="dropdown-item toggle-like-button" href="/likes/toggle/?id=${e.data.replyID}&type=CommentReply" data-likes="0" id="reply-${e.data.replyID}-like-toggle">Like <i class="far fa-thumbs-up"></i></a>\n                                    </div>\n                                </div>\n                                    <div class="modal fade" tabindex="-1" role="dialog" id="deleteReplyModal-${e.data.replyID}" aria-labelledby="exampleModalLabel" aria-hidden="true">\n                                    <div class="modal-dialog replydeletemodaldialog" role="document">\n                                        <div class="modal-content">\n                                        <div class="modal-header">\n                                            <h2 class="modal-title"><i class="fas fa-trash-alt"></i> Reply?</h2>\n                                        </div>\n                                        <div class="modal-body">\n                                            <p>Are you sure you want to delete it?</p>\n                                        </div>\n                                        <div class="modal-footer">\n                                            <a href="/comments/destroy-comment-reply/${e.data.replyID}" class="delete-reply-button btn btn-danger" data-dismiss="modal">Remove</a>\n                                            <button type="button" class="btn btn-light" data-dismiss="modal">Discard</button>\n                                        </div>\n                                        </div>\n                                    </div>\n                                    </div>\n                                    <div class="reply-author-tag">\n                                        <a href="/users/profile/${e.data.replyUserID}">\n                                            \n                                            \n                                            <span>${e.data.replyUserName}</span>\n                                            <span class="${e.data.authorTag}-tag" style="width: 45px;"> ${e.data.authorTag}</span>\n                                            \n                                        </a>\n                                    </div>\n                                \n                                    <div class="reply-content" id="reply-${e.data.replyID}-content">\n                                            <div class="removetag" id="removetag-${e.data.replyID}">\n                                                <a href="/comments/reply-remove-tag/${e.data.replyID}" class="removetag-button">Remove Tag?</a>\n                                            </div>\n                                        <a href="/users/profile/${e.data.replyContent.originalAuthorID}" onmouseover="removetagVisible(this)" name="${e.data.replyID}">\n                                              ${e.data.replyContent.originalAuthorName}\n                                             \n                                        </a>\n                                          <span class="replyreplycontent">  ${e.data.replyContent.content}</span>\n                                    </div>\n                                    \n                                    </li>`);e.data.replyUserImage?$(" .reply-author-tag a",n).prepend(`<img src=${e.data.replyUserImage}>`):$(" .reply-author-tag a",n).prepend(`<div class="concealed-image" style="background:${e.data.replyUserBgColor};"><span>${e.data.replyUserName.split(" ")[0].charAt(0)}</span></div>`),$(`#comment-${e.data.commentID}-reply-list`).prepend(n),t.deleteReply($(" .delete-reply-button",n)),t.updateReply($(" .update-reply-button",n)),t.replyReply1($(" .reply-reply-button",n)),t.removeTag($(" .removetag-button",n)),new ToggleLike($(" .toggle-like-button",n)),new Noty({theme:"relax",text:"Reply published successfully!",type:"success",layput:"topRight",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}))}(t)},error:function(e){console.log(e.responseText)}})}))}removeTag(e){$(e).click((function(t){t.preventDefault(),console.log("inside remove tag button "),$.ajax({type:"get",url:$(e).prop("href"),success:function(e){console.log(e.data,$("#reply-"+e.data.replyID)),$(`#reply-${e.data.replyID} .reply-content a`).remove(),$(`#reply-${e.data.replyID} .reply-content .removetag`).remove(),new Noty({theme:"relax",text:"This tag have fallen for you!",type:"success",layout:"topRight",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}))}}