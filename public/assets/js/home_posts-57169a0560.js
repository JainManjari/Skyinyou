{let t=function(){let t=$("#new-post-form");t.submit((function(e){e.preventDefault(),$.ajax({type:"post",url:"/posts/create-post",data:t.serialize(),success:function(t){console.log(t.data.post);let e=s(t.data.post);t.data.post.user.avatar?($(" .author-post-name a",e).prepend(`<img src=${t.data.post.user.avatar}>`),$(" .shared-post-form a",e).prepend(`<img src=${t.data.post.user.avatar}>`)):($(" .author-post-name a",e).prepend(`<span class="concealed-image" style="background:${t.data.post.user.info.bgColor}"><span>${t.data.post.user.name.split(" ")[0].charAt(0)}</span></span>`),$(" .shared-post-form p a",e).prepend(`<span class="concealed-image" style="background:${t.data.post.user.info.bgColor}"><span>${t.data.post.user.name.split(" ")[0].charAt(0)}</span></span>`)),$("#posts-list-container>ul").prepend(e),o($(" .delete-post-button",e)),a($(" .update-post-button",e)),new PostComments(t.data.post._id),new ToggleLike($(" .toggle-like-button",e)),new SharePost($(" .toggle-share-button",e)),new Noty({theme:"relax",text:"So, now you write too. What can't you do?",type:"success",layput:"topRight",timeout:1500}).show()},error:function(t){console.log(t.responseText)}})}))},s=function(t){return $(`\n\n        <li class="post-list animated-box in" id="post-${t._id}">\n           \n        <div class="post-like-box">\n            <div class="post-likes-number" id="post-${t._id}-likes-number">\n                <span data-target="#post-${t._id}-likes" data-toggle="modal"></span>\n                <a class="toggle-like-button" href="/likes/toggle/?id=${t._id}&type=Post" data-likes="0">\n                    <i class="fas fa-thumbs-up like-thumbs"></i>\n                </a>\n            </div>\n            <div class="modal fade" id="post-${t._id}-likes" role="dialog">\n                <div class="modal-dialog">\n                \n                \x3c!-- Modal content--\x3e\n                <div class="modal-content">\n                    <div class="modal-header">\n                    <h4 class="modal-title" id="post-${t._id}-like-title">Post Reactions  \n                        <span><i class="far fa-heart"></i></span></h4>\n                    </div>\n                    <div class="modal-body">\n                        <ul  class="post-like-username-list" id="post-${t._id}-likes-list">\n                            \n                    \n                        </ul>\n                    </div>\n                \n                </div>\n                \n                </div>\n          </div>\n   \n    \n        </div>\n        \n        <small class="post-deletion"> \n        <span data-toggle="modal" data-target="#post-${t._id}-delete-modal" class="delete-post-modal">\n        <i class="fas fa-trash-alt"></i>\n    </span>\n    <div class="modal fade post-delete-modal" tabindex="-1" role="dialog" id="post-${t._id}-delete-modal">\n        <div class="modal-dialog" role="document">\n          <div class="modal-content">\n            <div class="modal-header">\n              <h2 class="modal-title"><i class="fas fa-trash-alt"></i> Post?</h2>\n            </div>\n            <div class="modal-body">\n              <p style="text-align:left;">Are you sure you want to delete it? All the likes, comments and replies will be lost forever.</p>\n            </div>\n            <div class="modal-footer">\n              <a href="/posts/destroy-post/${t._id}" class="delete-post-button btn btn-danger" data-dismiss="modal">Remove</a>\n              <button type="button" class="btn btn-light" data-dismiss="modal">Discard</button>\n            </div>\n          </div>\n        </div>\n      </div>\n        \n        </small>\n        <small class="updateposttag"> \n            <a href="/posts/update-post/${t._id}" class="update-post-button">\n                <i class="fas fa-pen-fancy"></i>\n            </a>\n        </small>\n        <small class="author-post-name">\n            <a href="/users/profile/${t.user._id}">\n               \n                <span>${t.user.name}</span>\n            </a>\n        </small>\n\n        <div class="post-content" id="post-${t._id}-content">\n         \n            <div class="post-text">\n               <span> ${t.content}</span>\n            </div>\n            <div class="post-comments">\n                <form action="/comments/create-comment" method="post" id="post-${t._id}-comments-form">\n                    <textarea type="text" name="content" placeholder="Type here to add comment...." required onkeydown="autosize1(this)"></textarea>\n                    <input type="hidden" name="post" value="${t._id}">\n                    <button type="submit">Add comment</button>\n                </form>\n                <div class="post-comment-number" id="post-${t._id}-comment-number" data-comments="0" data-target="#post-comments-${t._id}-list"  >\n                <span >\n                    \n                </span>\n                <i class="fas fa-comments"></i>\n            </div>\n            </div>\n            <div class="post-comments-list collapse" id="post-comments-${t._id}-list">\n                <ul id="post-comments-${t._id}">\n                   \n                </ul>\n        \n            </div>\n        </div>\n        <div class="post-timestamps">\n            ${t.createdAt.toLocaleString()}\n        </div>\n        <div class="post-share-box">\n      \n        <div class="post-shares-number" id="post- ${t._id}-shares-number">\n            <span class="post-shares-no-display" data-target="#post-${t.id}-shares" data-toggle="modal" ></span>\n            <span data-toggle="modal" data-target="#post-${t._id}-share-modal">\n            <i class="fas fa-share-square"></i>\n            </span>\n        </div>\n        \n        <div class="modal fade" id="post-${t._id}-shares" role="dialog">\n            <div class="modal-dialog">\n            \n              \x3c!-- Modal content--\x3e\n              <div class="modal-content">\n                <div class="modal-header">\n                  <h4 class="modal-title" id="post-${t._id}-share-title">Post Shares \n                    <span>\n                   \n                    <i class="fas fa-share"></i>\n                    </span></h4>\n                </div>\n                <div class="modal-body">\n                    <ul  class="post-share-username-list" id="post-${t._id}-shares-list">\n                       \n                \n                    </ul>\n                </div>\n               \n              </div>\n              \n            </div>\n          </div>\n\n        <div class="modal post-share-modal fade" id="post-${t._id}-share-modal" role="dialog" >\n            <div class="modal-dialog">\n            \n              \x3c!-- Modal content--\x3e\n              <div class="modal-content">\n                <div class="modal-header">\n                  <h4 class="modal-title" id="#post-${t._id}-title">Share this Post?\n                      <br></h4>\n                </div>\n                <div class=" modal-body"  >\n                <form action="/posts/share-post/" method="post" class="toggle-share-button" data-shares="0" id="post-${t._id}-share-form">\n                <textarea name="content" required onkeydown="autosize1(this)">Add some thoughts to it!!!</textarea> \n                <input type="hidden" name="post" value="${t._id}">\n                \n            \n                <div class="shared-post-form">\n                    <p>\n                        <a href="/users/profile/${t.user._id}">\n                            \n                              \n                                <span class="author-name">${t.user.name}</span>\n                        </a>\n                    </p>\n                    <p class="share-content">\n                        ${t.content}\n                    </p>\n                </div>\n                <div class="modal-footer">\n                    <button onclick="submitForm(this)" class="btn btn-secondary" data-dismiss="modal" name="${t._id}">Submit</button>\n                </div>\n            </form>\n            \n                    \n                </div>\n              \n            </div>\n          </div>\n   \n    \n        </div>\n        </li>`)},o=function(t){$(t).click((function(s){s.preventDefault(),$.ajax({type:"get",url:$(t).prop("href"),success:function(t){if(console.log(t.data),$("#post-"+t.data.postID).remove(),null!=t.data.shareID){let s=parseInt($(`#post-${t.data.originalPostID}-share-form`).attr("data-shares"));s-=1,$(`#post-${t.data.originalPostID}-share-form`).attr("data-shares",s),s>0?($(`#post-${t.data.originalPostID}-shares-number .post-shares-no-display`).html(""+s),$(`#post-${t.data.originalPostID}-share-title span`).html(s+' <i class="fas fa-share-square"></i>')):($(`#post-${t.data.originalPostID}-shares-number .post-shares-no-display`).html(""),$(`#post-${t.data.originalPostID}-share-title span`).html('<i class="fas fa-share-square"></i>')),$("#share-"+t.data.shareID).remove()}else if(null!=t.data.bornPosts)for(let s of t.data.bornPosts)console.log(s),$(`#post-${s._id}-content .post-text .copiedPost`).html('<p class="deletedOriginalPost">The Original Post is deleled!</p>'),$(`#post-${s._id} .post-share-box`).remove();$(".modal-backdrop").remove(),$("body").removeClass("modal-open"),new Noty({theme:"relax",text:"This post and its company needs a funeral!",type:"success",layput:"topRight",timeout:1500}).show()},error:function(t){console.log(t.responseText)}})}))},a=function(t){$(t).click((function(s){s.preventDefault(),$.ajax({type:"post",url:$(t).prop("href"),success:function(t){console.log(t.data),$("#posts-list-container>ul>li").each((function(){let t=$(this),s=$(" .updateposttag",t);console.log(s);let o=$(" .update-post-button",s);console.log(o),o.css("pointer-events","none"),s.css("cursor","no-drop")})),$(`#post-${t.data.postID} .post-deletion`).css("cursor","no-drop"),$(`#post-${t.data.postID} .post-deletion span`).css("pointer-events","none"),$(`#post-${t.data.postID}-content .post-text > span`).remove(),t.data.shared?$(`#post-${t.data.postID}-content .post-text`).prepend(`<form action="/posts/update-post-p2" method="post" class="post-update-form">\n                                <textarea required  name="content" onkeydown="autosize1(this)">${t.data.content.newContent}</textarea>\n                                <input type="hidden" name="post" value="${t.data.postID}">\n                                <button type="submit">Update</button>\n                                </form>`):$(`#post-${t.data.postID}-content .post-text`).prepend(`<form action="/posts/update-post-p2" method="post" class="post-update-form">\n                                <textarea required  name="content" onkeydown="autosize1(this)">${t.data.content}</textarea>\n                                <input type="hidden" name="post" value="${t.data.postID}">\n                                <button type="submit">Update</button>\n                                </form>`),e()},error:function(t){console.log(t.responseText)}})}))},e=function(){$(".post-update-form").submit((function(t){t.preventDefault(),$.ajax({type:"post",url:"/posts/update-post-p2",data:$(".post-update-form").serialize(),success:function(t){console.log(t.data),$("#posts-list-container>ul>li").each((function(){let t=$(this),s=$(" .updateposttag",t);console.log(s);let o=$(" .update-post-button",s);console.log(o),o.css("pointer-events","auto"),s.css("cursor","pointer")})),$(`#post-${t.data.postID} .post-deletion`).css("cursor","pointer"),$(`#post-${t.data.postID} .post-deletion span`).css("pointer-events","auto"),$("#posts-list-container>li>.update-post-button").each((function(){let t=$(this);console.log(t);let s=$(" i",t);console.log(s),s.css("pointer-events","auto"),t.css("cursor","poniter")})),1==t.data.edited&&(console.log("yes"),$("#post-"+t.data.postID).prepend('<small class="post-editedTag">\n                        Edited\n                        </small>')),$(`#post-${t.data.postID}-content .post-text form`).remove(),$(`#post-${t.data.postID}-content .post-text`).prepend(`<span>${t.data.content}</span>`),new Noty({theme:"relax",text:"This post had a successful affair of words!",type:"success",layput:"topRight",timeout:1500}).show()},error:function(t){console.log(t.responseText)}})}))},n=function(){console.log("converting posts to ajax "),$("#posts-list-container>ul>li").each((function(){let t=$(this),s=$(" .delete-post-button",t),e=$(" .update-post-button",t);a(e),o(s);let n=t.prop("id").split("-")[1];new PostComments(n)}))};t(),n()}